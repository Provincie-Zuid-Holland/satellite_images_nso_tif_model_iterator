Metadata-Version: 2.1
Name: satellite_images_nso_tif_model_iterator
Version: 1.0.0
Summary: NSO Satellite Model implementer
Home-page: https://github.com/Provincie-Zuid-Holland/satellite_images_nso_tif_model_iterator
Author: Michael de Winter
Author-email: m.r.dewinter88@live.nl
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.6
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: requests>=2.25.0
Requires-Dist: objectpath>=0.6.1
Requires-Dist: earthpy>=0.9.2
Requires-Dist: Fiona>=1.8.13
Requires-Dist: geopandas>=0.7.0
Requires-Dist: rasterio>=1.1.3
Requires-Dist: Shapely>=1.7.0

# Introduction

This repository contains a .tif file  model inferencer which means that it iterates and implements a (computer vision) model on every pixel and/or extracted image kernel in a .tif file.
As long as a model has a .predict function in python any model can be used in this executer from simple models to deep learning models.
For more on what image processing kernels are: [Here](<https://en.wikipedia.org/wiki/Kernel_(image_processing)>)

!Currently only pixels are supported!

# Installation

When working with 64x Windows and Anaconda for your python environment management execute the following terminal commands in order:

```sh
conda create -n satellite_images_nso_tif_model_iterator python=3.12 -y
conda activate satellite_images_nso_tif_model_iterator
pip install -r requirements.txt
```

Navigate to the [satellite-images-nso-datascience repository](https://github.com/Provincie-Zuid-Holland/satellite-images-nso-datascience) and then run:

```sh
rebuild.bat
```


# Application and example

Copy `settings_example.py` and rename to `settings.py`. Change the variables in there as desired and then execute `example_iterator.py`.


```python

import settings
from src.filenames.file_name_generator import OutputFileNameGenerator
from src.tif_model_iterator import tif_kernel_iterator


if __name__ == "__main__":
    filename = settings.MODEL_PATH
    tif_file = settings.TIF_FILE_INPUT
    output_path = settings.OUTPUT_PATH

    loaded_model = pickle.load(open(filename, "rb"))
    print("Loaded model: "+filename.split("/")[-1])

    print("Implementing model on: "+tif_file)

    # Generates a output name
    output_file_name_generator = OutputFileNameGenerator(
            output_path=output_path, output_file_name= output_path + tif_file.split("/")[-1].replace(".tif", ".geojson")
        )

    # Initialize the iterator
    nso_tif_kernel_iterator_generator = (
            tif_kernel_iterator.TifKernelIteratorGenerator(
                path_to_tif_file=tif_file,
                model=loaded_model["model"],
                output_file_name_generator=output_file_name_generator,
                parts=4,
                normalize_scaler=loaded_model["scaler"],
                column_names=["r", "g", "b", "n", "e", "d", "ndvi", "re_ndvi"],
            )
    )

    # Run the prediction.
    nso_tif_kernel_iterator_generator.predict_all_output()


```
# Performance

We have encountered issue's with writing to .shp files on high resolutions.
Better to always use .geojson format.

# Author

Michael de Winter, Pieter Kouyzer

# Contact

Contact us at vdwh@pzh.nl
